# GUI Services - Модульная архитектура

Этот каталог содержит модульную реализацию пользовательского интерфейса для системы оптимизации расписания.

## Структура модулей

### `ui_builder.py`
**Назначение**: Создание элементов пользовательского интерфейса
- Настройка главного окна
- Создание фреймов и панелей
- Создание кнопок (одинарных, двойных, тройных)
- Создание элементов логирования
- Создание статус-бара

**Основные методы**:
- `create_main_window()` - настройка главного окна
- `create_single_button()` - создание кнопки на всю ширину
- `create_double_button_row()` - создание двух кнопок в строке
- `create_triple_button_row()` - создание трех кнопок в строке

### `file_manager.py`
**Назначение**: Управление файлами и их открытием
- Универсальное открытие файлов в зависимости от ОС
- Открытие веб-файлов через браузер
- Диалоги выбора файлов и каталогов
- Проверка существования файлов и каталогов

**Основные методы**:
- `open_file()` - универсальное открытие файлов
- `open_web_file()` - открытие HTML файлов
- `select_directory()` - диалог выбора каталога
- `select_xlsx_file()` - диалог выбора Excel файлов

### `process_manager.py`
**Назначение**: Управление процессами и терминалами
- Запуск команд в терминале
- Создание новых терминальных окон
- Управление фоновыми процессами
- Кроссплатформенная поддержка терминалов

**Основные методы**:
- `execute_in_terminal()` - выполнение команд в терминале
- `start_new_terminal_with_commands()` - запуск нового терминала
- `is_process_running()` - проверка активности процесса

### `app_actions.py`
**Назначение**: Бизнес-логика приложения
- Обработчики всех действий пользователя
- Координация между различными модулями
- Валидация входных данных
- Управление состоянием приложения

**Основные методы**:
- `run_scheduler()` - запуск планировщика
- `run_gear_xls()` - запуск веб-генератора
- `run_visualiser()` - запуск визуализатора
- `convert_to_xlsm()` - конвертация файлов

### `logger.py`
**Назначение**: Система логирования
- Запись действий в лог с временными метками
- Обновление статус-бара
- Управление отображением сообщений

**Основные методы**:
- `log_action()` - запись действия в лог
- `clear_log()` - очистка лога
- `set_status()` - установка статуса

## Использование

Главный файл `gui.py` импортирует все модули и координирует их работу:

```python
from gui_services import UIBuilder, FileManager, ProcessManager, AppActions, Logger
```

## Преимущества модульной архитектуры

1. **Разделение ответственности**: Каждый модуль отвечает за свою область функциональности
2. **Легкость тестирования**: Модули можно тестировать независимо
3. **Расширяемость**: Новая функциональность добавляется в соответствующий модуль
4. **Поддерживаемость**: Код легче читать и модифицировать
5. **Переиспользование**: Модули могут использоваться в других проектах

## Зависимости между модулями

```
gui.py (главный файл)
├── UIBuilder (создание интерфейса)
├── ProcessManager (управление процессами)
├── FileManager (работа с файлами)
├── Logger (логирование)
└── AppActions (бизнес-логика)
    ├── использует ProcessManager
    ├── использует FileManager
    └── использует Logger (через callback)
```

## Расширение функциональности

Для добавления новой функциональности:

1. **UI элементы**: добавить методы в `UIBuilder`
2. **Файловые операции**: добавить методы в `FileManager`
3. **Процессы**: добавить методы в `ProcessManager`
4. **Бизнес-логика**: добавить методы в `AppActions`
5. **Главное окно**: обновить `gui.py` для использования новых возможностей
