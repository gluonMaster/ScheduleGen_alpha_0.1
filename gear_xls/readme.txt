# Генератор расписания из Excel

Программа для генерации и визуализации школьного расписания занятий на основе Excel-файла с исходными данными.

## Возможности

- Загрузка и обработка Excel-файлов расписания
- Создание интерактивной HTML-версии с возможностью перетаскивания блоков занятий
- Возможность скрыть/показать определенные дни недели
- Сохранение промежуточных версий расписания
- Создание финальной статической версии для публикации
- Генерация PDF-файлов для печати (формат A2, альбомная ориентация)

## Структура проекта

Проект разделен на модули, каждый из которых отвечает за определенную функциональность:

- `main.py` - Основной файл программы с GUI интерфейсом
- `excel_parser.py` - Модуль для обработки Excel-файлов с расписанием
- `schedule_structure.py` - Модуль для формирования структуры расписания
- `html_generator.py` - Модуль для создания HTML-версии расписания
- `pdf_generator.py` - Модуль для генерации PDF-файлов
- `utils.py` - Вспомогательные функции

## Установка

1. Клонируйте репозиторий
2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```
3. Установите wkhtmltopdf (для генерации PDF):
   - Загрузите с официального сайта: https://wkhtmltopdf.org/downloads.html
   - Или используйте ваш пакетный менеджер:
     - Для Ubuntu/Debian: `sudo apt-get install wkhtmltopdf`
     - Для macOS: `brew install wkhtmltopdf`

## Использование

1. Запустите программу:
   ```
   python main.py
   ```
2. Выберите Excel-файл с расписанием (формат должен соответствовать описанию)
3. Нажмите кнопку "Создать веб-версию и PDF файлы расписания"
4. В результате будут созданы:
   - HTML-файл с интерактивным расписанием (в папке html_output)
   - PDF-файлы для каждого здания (в папке pdfs)

## Интерактивное расписание

HTML-версия расписания позволяет:
- Показывать/скрывать дни недели с помощью кнопок в верхней части страницы
- Перетаскивать блоки занятий для корректировки расписания
- Сохранять промежуточные версии для дальнейшего редактирования
- Создавать финальную статическую версию для публикации

## Требования

- Python 3.6+
- pandas
- openpyxl
- pdfkit
- wkhtmltopdf

## Формат Excel-файла

Программа ожидает Excel-файл со следующей структурой:
- Лист с именем "Schedule"
- Данные начиная со второй строки
- Столбцы:
  - A - название дисциплины
  - B - название группы
  - C - имя преподавателя
  - D - кабинет
  - E - здание
  - F - день недели
  - G - время начала урока
  - H - время окончания урока
  - I - продолжительность урока в минутах

## Особенности

- Временной интервал для отображения в сетке расписания - 5 минут
- Названия кабинетов могут иметь формат "VK.07" или "K2.3", где первый символ указывает на здание
